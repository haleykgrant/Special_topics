---
title: "NHANES_special_topics"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(rnhanesdata)
library(ggplot2)
library(ggpubr)
library(dplyr)
library(tidyr)

load("PAXINTEN_C.rda")
load("PAXINTEN_D.rda")
load("Covariate_C.rda")
load("Covariate_D.rda")

```



```{r summary stats and basics}
#colnames(PAXINTEN_C)

# View number of inadeequate rows
ggc1 = ggplot(data = PAXINTEN_C, aes(x = PAXCAL))+geom_bar(aes(fill = PAXCAL==1),position = position_dodge(width = 0.8), width=0.5)+
  labs(title = "PAXCAL Distribution in 2003-2004")+
  scale_fill_discrete(name = NULL,labels = c("Possibly Inaccurate","Adequate Data"))+
  theme_bw()
ggc2 = ggplot(data = PAXINTEN_C, aes(x = PAXSTAT))+geom_bar(aes(fill = PAXSTAT==1),position = position_dodge(width = 0.8), width=0.5)+
  labs(title = "PAXSTAT Distribution in 2003-2004")+
  scale_fill_discrete(name = NULL,labels = c("Possibly Inaccurate","Adequate Data"))+
  theme_bw()
ggd1 = ggplot(data = PAXINTEN_D, aes(x = PAXCAL))+geom_bar(aes(fill = PAXCAL==1),position = position_dodge(width = 0.8), width=0.5)+
  labs(title = "PAXCAL Distribution in 2005-2006")+
  scale_fill_discrete(name = NULL,labels = c("Possibly Inaccurate","Adequate Data"))+
  theme_bw()
ggd2 = ggplot(data = PAXINTEN_D, aes(x = PAXSTAT))+geom_bar(aes(fill = PAXSTAT==1),position = position_dodge(width = 0.8), width=0.5)+
  labs(title = "PAXSTAT Distribution in 2005-2006")+
  scale_fill_discrete(name = NULL, labels = c( "Possibly Inaccurate","Adequate Data"))+
  theme_bw()

ggarrange(ggc1,ggd1, ncol = 2,common.legend = T, legend = "bottom")
ggarrange(ggc2,ggd2, ncol = 2, common.legend = T, legend = "bottom")


```


```{r}
mn.na = function(var) {
  return(mean(var, na.rm = T))
}
x = data.frame(apply(PAXINTEN_C[,c(6:1445)], 2, mn.na))
colnames(x) = "val"
x$time = as.numeric(substr(rownames(x),4,stop = nchar(rownames(x))))

gg =ggplot(data = x, aes(x = time, y = val ))+geom_path(size = 0.5)+
  labs(y = "Average Activity Count")+
  scale_x_continuous(breaks = seq(0, max(x$time), by = 120))
  
gg


```


